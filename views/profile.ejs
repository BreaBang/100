<%- include('partials/header') -%>

 <!-- Image Banner -->
 <div class="container image-banner">
  <div class="row justify-content-md-center">
    <div class="col">
    </div>
    <div class="col-md-auto"><img src="/imgs/journal-banner.png"> 
    </div>
    <div class="col">
    </div>
  </div>

<!-- User Profile Grid -->
<section class="profile-grid border border-primary rounded">
<div class="row">
  <div class="col-3 card profile-card" data-name='<%=user._id%>' data-id='<%=user._id%>'>
      <img class="card-img-top" src="<%= user.img %>" alt="Card image cap">
      <div class="card-body">
        <p class="card-text"><%= user.userName%></p>
        <!-- Profile Photo Update -->
        <% if(user._id == userId) {%>
          <form action="/addProfileImg?_method=PUT" enctype="multipart/form-data" method="POST">
            <div class="row">
              <label for="imgUpload" class="form-label">Change Photo: </label>
              <input type="file" class="form-control" id="imageUpload" name="file">
            </div>
            <button type="submit" class="btn btn-primary btn-lg btn-goal" value="Upload">Submit</button>
        </form>
       
          <% } %>
      </div>
  </div>
  <div class="col-8">
     <!-- Races -->
     <h5>Races:</h5>
     <table class="table">
       <thead>
         <tr>
           <th scope="col">Race Name</th>
           <th scope="col">Date and Start Time</th>
           <%if(user.user == user.id){ %> <th scope="col"><span class="fa fa-trash"></span></th> <% } %>
         </tr>
       </thead>
         <tbody>
         <% races.forEach(el => { %>
           <tr class='raceItem' data-name='<%=el.user._id%>' data-id='<%=el._id%>'>
             <td><span><%=el.race %></span></td>
             <td><span>
              <time datetime="<%=new Date(el.raceDate).toDateString()%>" class="font-extrabold text-2xl"><%= new Date(el.raceDate).toLocaleDateString('en', { year: 'numeric' , month: 'short' , day: '2-digit' }) %></time>
             </span></td>
             <%if(user.user == user.id){ %>
             <td>
              <span> <form
             action="/race/deleteRACE/<%= el._id%>?_method=DELETE"
             method="POST"
             class="col-3"
           >
             <button class="btn btn-dark fa fa-trash" type="submit"></button>
           </form>
           </span>
           <% } %>
          </td>
           </tr>
         <% }) %>
         </tbody>
       </table>

   <!-- Goals -->
   <h5>Goals:</h5>
   <table class="table">
     <thead>
       <tr>
         <th scope="col">Date Added</th>
         <th scope="col">Goal</th>
         <%if(user.user == user.id){ %> <th scope="col"><span class="fa fa-trash"></span></th><% } %>
       </tr>
     </thead>
       <tbody>
       <% goals.forEach(el => { %>
         <tr class='goalItem' data-name='<%=el.user%>' data-id='<%=el._id%>'>
           <td><span><%=el.createdAt.toDateString() %></span></td>
           <td><span class ='<%= el.completed === true ? 'completed' : 'not'%>'><%= el.goal %></span></td>
           <%if(user.user == user.id){ %>
           <td><span> <form
           action="/goal/deleteGoal/<%= el._id%>?_method=DELETE"
           method="POST"
           class="col-3"
         >
           <button class="btn btn-dark fa fa-trash" type="submit"></button>
         </form>
         </span></td><% } %>
         </tr>
       <% }) %>
       </tbody>
     </table>

  </div>
</div>
</section>
       
<!-- Running Journal -->
<!--If entries add here -->
<h4><%= user.userName %>'s Running Journal</p></h4>
<h5>Journal Entries:</h5>
<table class="table">
  <thead>
    <tr>
      <th scope="col">Date</th>
      <th scope="col">Title</th>
      <th scope="col">Status</th>
      <%if(user.user == user.id){ %>
      <th scope="col"><span class="fa fa-trash"></span></th>
      <% } %>
    </tr>
  </thead>
    <tbody>
    <% entries.forEach(el => { %>
      <tr class='entries' data-name='<%=el.user%>' data-id='<%=el._id%>'>
        <td><span><%=el.createdAt.toDateString() %></span></td>
        <td><span> <a href="/entries/<%= el._id%>"><%=el.title %> </a></span></a></td>
        <td><span><%=el.status %> </span></td>
        <td><%if(user.user == user.id){ %>
          <span> 
          <form
            action="/entries/deleteEntry/<%= el._id%>?_method=DELETE"
            method="POST"
            class="col-3"
          >
            <button class="btn btn-dark fa fa-trash" type="submit"></button>
          </form>
          </span>
          <% } %>
        </td>
      </tr>
    <% }) %>
    </tbody>
  </table>

<div class="space"></div>

<%- include('partials/footer') -%>